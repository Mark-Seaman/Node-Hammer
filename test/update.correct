----------------------------------------------------
                       bin/doc-diff-all                           
----------------------------------------------------
9,15c9
<     x=`diff $f $1/$f`
<     [ ! -z "$x" ]                                               &&
<     echo '----------------------------------------------------' &&
<     echo "                       $f                           " &&
<     echo '----------------------------------------------------' &&
<     diff $f $1/$f
<     #[ ! -z "`diff $f $1/$f`" ] && echo "DIFF $f:" && diff $f $1/$f
---
>     [ ! -z "`diff $f $1/$f`" ] && echo "DIFF $f:" && diff $f $1/$f
----------------------------------------------------
                       bin/mkexe                           
----------------------------------------------------
18c18
< e $p/bin/$cmdname
\ No newline at end of file
---
> e $p/bin/$cmdname
----------------------------------------------------
                       bin/rmas                           
----------------------------------------------------
6c6
< [[ ! -z "$x" ]] && echo $x && rm $x
---
> [ ! -z "$x" ] && echo $x && rm $x
10c10,14
< [[ ! -z "$x" ]] && echo $x && rm $x
---
> [ ! -z "$x" ] && echo $x && rm $x
> 
> echo 'Git libpeerconnection files'
> x=`find $1 -name libpeerconnection.log`
> [ ! -z "$x" ] && echo $x && rm $x
----------------------------------------------------
                       bin/tdiff                           
----------------------------------------------------
5,6d4
< cd $p/test
< 
8c6
< t=$f.tmp
---
> [ ! -x $f.tst ]  && cd $p/test 
11c9,13
< [[ ! -f $f.correct ]] && cp $f.out $f.correct
---
> [ ! -f $f.correct ] && cp $f.out $f.correct
> 
> # Filter the output
> [ -x $f.filter   ] && mv $f.out $f.tmp && $f.filter < $f.tmp > $f.out
> rm -f $f.tmp
15a18,20
> # Create the like file if error
> [[   -s $f.diff ]] && tmklike $f
> [[ ! -s $f.diff ]] && rm -f $f.like
----------------------------------------------------
                       bin/te                           
----------------------------------------------------
4c4
< e $p/test/$1.tst
\ No newline at end of file
---
> e $p/test/${1/.tst/}.tst
----------------------------------------------------
                       bin/tfail                           
----------------------------------------------------
3a4,5
> d="$1"
> [ "$1" == "" ] && d=$pt
5c7
< cd $p/test
---
> cd $d
7c9,14
<     for f in *.tst
---
>     
>     files=`ls $d/*.tst`
>     #echo "Tests: $files"
>     [ -z "$files" ] && echo "ERROR: no tests found $d" && exit 1
> 
>     for f in $files
8a16
>         #echo "tdiff $f"
----------------------------------------------------
                       bin/tlist                           
----------------------------------------------------
4,5c4,12
< cd $p/test
< ls *.tst | while read t; do echo ${t/\.tst/}; done
---
> d=$1
> [ -z "$d" ] && d="$pt"
> cd $d
> 
> ls *.tst | 
> while read t
> do 
>     echo ${t/\.tst/}
> done
----------------------------------------------------
                       bin/tout                           
----------------------------------------------------
5c5,7
< cat $p/test/$f.out
---
> [ -f $f.out     ] && cat $f.out && exit 0
> [ -f $pt/$f.out ] && cat $f.out && exit 0
> echo "No file found: $f.out"
----------------------------------------------------
                       bin/tresults                           
----------------------------------------------------
7a8
> {
11c12
<     [ ! -z "$x" ]                                               &&
---
>     [[ ! -z "$x" ]]                                             &&
16a18
> } | less
----------------------------------------------------
                       bin/trun                           
----------------------------------------------------
4c4
< cd $p/test              && 
---
> # Execute in this directory or the project test directory
6c6
< $f.tst > $f.out
---
> [ ! -x $f.tst ]  && cd $p/test 
7a8,22
> # Check for the test file
> [ ! -x $f.tst ]         && 
> echo "No test found, $f.tst" && 
> exit 0
> 
> t=/tmp/trun$$
> echo -n "Running test ... $f ... "
> $p/bin/elapsed "$f.tst > $t"
> 
> # Display the output
> [ -x $f.display   ] && $f.display < $t > $f.out
> [ ! -x $f.display ] && mv $t $f.out
> rm -f $t
> 
> # Compare the results to expected
----------------------------------------------------
                       bin/tshow                           
----------------------------------------------------
4,5c4,7
< echo 'Contents for ' $p/test/$1.tst
< cat  $p/test/$1.tst
---
> t=${1/.tst/}
> [ ! -x $t.tst ]  && t=$p/test/$t 
> echo 'Contents for ' $t.tst
> cat  $t.tst
----------------------------------------------------
                       bin/tst                           
----------------------------------------------------
5c5,7
< cd $p/test
---
> cd $1
> x=`ls *.tst` 2>/dev/null
> [ -z "$x" ] && cd $pt
9a12,15
> # Run the frame buffer server
> rbg Xvfb :99 -ac
> export DISPLAY=:99
> 
11,17c17,23
< echo "Run all tests"
< for f in *.tst 
< do
<     f=${f/.tst/}
<     echo "Running... $f"
<     trun $f
< done
---
> {
>     for f in *.tst 
>     do
>         f=${f/.tst/}
>         trun $f
>     done
> } | tee tst.out
20c26,29
< tfail
\ No newline at end of file
---
> tfail $1
> 
> # Stop the framebuffer server
> killall Xvfb
----------------------------------------------------
                       test/docs.tst                           
----------------------------------------------------
2c2
< # Test the documents
---
> # Watch for changes in the docs
5c5
< find | sort
---
> find | sort | grep -v '\.out'
----------------------------------------------------
                       test/files.tst                           
----------------------------------------------------
4c4,5
< ls $p $p/* | grep -v .pyc
---
> rmas $p # Remove autosave files
> ls $p $p/* | grep -v '\.pyc\|\.diff\|\.like\|\.out'
